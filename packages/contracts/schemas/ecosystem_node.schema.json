{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://travel.aw/schemas/ecosystem_node.schema.json",
  "title": "Ecosystem Node",
  "description": "Schema for a node in the TRAVEL.aw ecosystem graph. Authority A9. Conforms to Ecosystem Spec v0.2 §3.",
  "type": "object",
  "required": ["id", "name", "providerType", "description", "journeyStages", "capabilities", "addedVersion"],
  "additionalProperties": false,
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^(OTA|METASEARCH|DIRECT_SUPPLIER|CONTENT_PLATFORM|SOCIAL_PLATFORM|REVIEW_PLATFORM|ITINERARY_MANAGER|MAPPING_SERVICE|EVENT_PLATFORM|DMO|ENCYCLOPEDIA|FORUM|FINTECH|TRANSIT_SERVICE|LOYALTY_PLATFORM|SUPER_APP)_[A-Z0-9][A-Z0-9_]*$",
      "description": "Node ID. Format: {PROVIDER_TYPE}_{SNAKE_CASE_NAME}. Immutable once merged."
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Human-readable display name."
    },
    "providerType": {
      "type": "string",
      "enum": [
        "OTA",
        "METASEARCH",
        "DIRECT_SUPPLIER",
        "CONTENT_PLATFORM",
        "SOCIAL_PLATFORM",
        "REVIEW_PLATFORM",
        "ITINERARY_MANAGER",
        "MAPPING_SERVICE",
        "EVENT_PLATFORM",
        "DMO",
        "ENCYCLOPEDIA",
        "FORUM",
        "FINTECH",
        "TRANSIT_SERVICE",
        "LOYALTY_PLATFORM",
        "SUPER_APP"
      ],
      "description": "Provider type from provider_types.json (A6)."
    },
    "description": {
      "type": "string",
      "minLength": 1,
      "description": "1-3 sentence summary of what this node does in the ecosystem."
    },
    "journeyStages": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "enum": ["J0", "J1", "J2", "J3", "J4", "J5", "J6", "J7", "J8"]
      },
      "description": "Journey stages this node participates in. From journey_stages.json (A4)."
    },
    "capabilities": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": {
        "type": "string",
        "enum": [
          "C-SOCIAL-INSPIRATION",
          "C-CONTENT-PUBLISHING",
          "C-ENCYCLOPEDIA-KNOWLEDGE",
          "C-REVIEW-RATINGS",
          "C-FORUM-COMMUNITY",
          "C-FLIGHT-SEARCH",
          "C-HOTEL-SEARCH",
          "C-ACTIVITY-SEARCH",
          "C-PRICE-COMPARE",
          "C-METASEARCH",
          "C-BOOKING-TXN",
          "C-TICKETING",
          "C-INSURANCE",
          "C-ITINERARY-MGMT",
          "C-EMAIL-PARSING",
          "C-CALENDAR-SYNC",
          "C-MAPPING-NAV",
          "C-LOCAL-DISCOVERY",
          "C-EVENT-DISCOVERY",
          "C-TRANSIT-INFO",
          "C-EXPENSE-MGMT",
          "C-LOYALTY-MGMT",
          "C-AI-AGENT",
          "C-API-PLATFORM"
        ]
      },
      "description": "Capability codes from capabilities_registry.json (A5)."
    },
    "addedVersion": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Spec version when node was added (semver)."
    },
    "url": {
      "type": "string",
      "format": "uri",
      "description": "Primary URL if applicable."
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Free-form tags for discovery. Not authoritative — use capabilities for classification."
    },
    "notes": {
      "type": "string",
      "description": "Editorial notes."
    }
  }
}
